# AI Documentation Vector DB - Unified Environment Configuration Template
# Copy this file to .env and customize based on your deployment mode (simple/enterprise)
# All configuration uses AI_DOCS__ prefix for nested settings via Pydantic
# Required vars marked with *, optional with defaults or comments

# ========== Application Mode & Environment ==========
# * Required: Choose deployment mode
AI_DOCS__MODE=simple  # simple (solo dev, minimal) or enterprise (full features, monitoring)

# * Required: Environment type
AI_DOCS__ENVIRONMENT=development  # development, testing, staging, production

# Debug and logging
AI_DOCS__DEBUG=false  # true for development, false for production
AI_DOCS__LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# ========== Provider Selection ==========
# * Required: Embedding provider
AI_DOCS__EMBEDDING_PROVIDER=fastembed  # fastembed (local, no API key) or openai (cloud)

# * Required: Crawling provider
AI_DOCS__CRAWL_PROVIDER=crawl4ai  # crawl4ai (fast, local) or firecrawl (premium, API key)

# ========== API Keys (Mode-Dependent) ==========
# OpenAI (required if AI_DOCS__EMBEDDING_PROVIDER=openai or HyDE enabled)
AI_DOCS__OPENAI__API_KEY=sk-your-openai-api-key-here

# Firecrawl (required if AI_DOCS__CRAWL_PROVIDER=firecrawl)
AI_DOCS__FIRECRAWL__API_KEY=fc-your-firecrawl-api-key-here

# Qdrant Cloud (optional, leave empty for local)
AI_DOCS__QDRANT__API_KEY=

# ========== Service URLs ==========
# * Required: Qdrant Vector Database
AI_DOCS__QDRANT__URL=http://localhost:6333  # Local Docker or cloud URL

# Redis/Dragonfly Cache (enterprise mode)
AI_DOCS__CACHE__REDIS_URL=redis://localhost:6379

# ========== Performance Tuning ==========
# Concurrent operations (adjust based on hardware)
AI_DOCS__PERFORMANCE__MAX_CONCURRENT_CRAWLS=10  # simple: 5, enterprise: 50
AI_DOCS__PERFORMANCE__MAX_CONCURRENT_EMBEDDINGS=32
AI_DOCS__PERFORMANCE__REQUEST_TIMEOUT=30
AI_DOCS__PERFORMANCE__MAX_MEMORY_USAGE_MB=1000  # simple: 500, enterprise: 4000

# Batch sizes
AI_DOCS__BATCH__EMBEDDING_BATCH_SIZE=100  # simple: 10, enterprise: 200
AI_DOCS__BATCH__CRAWL_BATCH_SIZE=50

# ========== Cache Configuration ==========
AI_DOCS__CACHE__ENABLE_CACHING=true
AI_DOCS__CACHE__ENABLE_LOCAL_CACHE=true  # In-memory for all modes
AI_DOCS__CACHE__ENABLE_REDIS_CACHE=false  # true for enterprise only

# TTLs (seconds)
AI_DOCS__CACHE__TTL_EMBEDDINGS=86400  # 24 hours
AI_DOCS__CACHE__TTL_CRAWL=3600  # 1 hour
AI_DOCS__CACHE__TTL_QUERIES=7200  # 2 hours
AI_DOCS__CACHE__TTL_HYDE=14400  # 4 hours

# Cache sizes (enterprise)
AI_DOCS__CACHE__LOCAL_MAX_SIZE=1000  # simple: 500, enterprise: 10000
AI_DOCS__CACHE__LOCAL_MAX_MEMORY_MB=100  # simple: 50, enterprise: 1000

# ========== OpenAI Settings ==========
# Model and dimensions (if using OpenAI)
AI_DOCS__OPENAI__EMBEDDING_MODEL=text-embedding-3-small
AI_DOCS__OPENAI__DIMENSIONS=1536
AI_DOCS__OPENAI__API_BASE=https://api.openai.com/v1  # Optional custom endpoint

# HyDE (Hypothetical Document Embeddings) - enterprise only
AI_DOCS__HYDE__ENABLED=false  # true for enterprise
AI_DOCS__HYDE__MODEL=gpt-3.5-turbo
AI_DOCS__HYDE__MAX_TOKENS=150
AI_DOCS__HYDE__TEMPERATURE=0.7
AI_DOCS__HYDE__NUM_GENERATIONS=5  # simple: 3
AI_DOCS__HYDE__PREFETCH_LIMIT=50
AI_DOCS__HYDE__QUERY_WEIGHT=0.3

# RAG (Retrieval Augmented Generation) - enterprise only
AI_DOCS__RAG__ENABLED=false  # true for enterprise
AI_DOCS__RAG__MODEL=gpt-4
AI_DOCS__RAG__MAX_TOKENS=2000
AI_DOCS__RAG__TEMPERATURE=0.1
AI_DOCS__RAG__MAX_CONTEXT_LENGTH=8000

# ========== Qdrant Settings ==========
AI_DOCS__QDRANT__DEFAULT_COLLECTION=documentation
AI_DOCS__QDRANT__GRPC_PORT=6334
AI_DOCS__QDRANT__USE_GRPC=false  # true for enterprise performance

# Query settings
AI_DOCS__QUERY_API__PREFETCH_LIMIT=100  # simple: 50
AI_DOCS__QUERY_API__HNSW_EF=128
AI_DOCS__QUERY_API__QUANTIZATION_RESCORE=true
AI_DOCS__QUERY_API__OVERSAMPLING=2.0

# ========== Security Settings ==========
AI_DOCS__SECURITY__MAX_QUERY_LENGTH=1000
AI_DOCS__SECURITY__MAX_URL_LENGTH=2048
AI_DOCS__SECURITY__RATE_LIMIT_REQUESTS_PER_MINUTE=60  # simple: 50, enterprise: 1000
AI_DOCS__SECURITY__ALLOWED_DOMAINS=["*"]  # JSON array, restrict in production
AI_DOCS__SECURITY__REQUIRE_API_KEYS=false  # true for enterprise
AI_DOCS__SECURITY__ENABLE_RATE_LIMITING=true

# Circuit Breaker (enterprise)
AI_DOCS__CIRCUIT_BREAKER__ENABLED=false  # true for enterprise
AI_DOCS__CIRCUIT_BREAKER__FAILURE_THRESHOLD=5
AI_DOCS__CIRCUIT_BREAKER__RECOVERY_TIMEOUT=60.0

# Drift Detection (enterprise)
AI_DOCS__DRIFT_DETECTION__ENABLED=false  # true for enterprise
AI_DOCS__DRIFT_DETECTION__SNAPSHOT_INTERVAL_MINUTES=15

# ========== Chunking Strategy ==========
AI_DOCS__CHUNKING__STRATEGY=enhanced  # basic (simple), enhanced (enterprise), ast
AI_DOCS__CHUNKING__MAX_CHUNK_SIZE=1600  # simple: 1000
AI_DOCS__CHUNKING__MIN_CHUNK_SIZE=200
AI_DOCS__CHUNKING__OVERLAP=200  # simple: 50

# ========== Directory Paths ==========
AI_DOCS__DATA_DIR=./data
AI_DOCS__CACHE_DIR=./cache
AI_DOCS__LOGS_DIR=./logs

# ========== Browser Automation (Optional) ==========
AI_DOCS__BROWSER__DEFAULT_TOOL=crawl4ai  # crawl4ai, browser_use, playwright
AI_DOCS__BROWSER__ENABLE_FALLBACK=true
AI_DOCS__BROWSER__HEADLESS=true
AI_DOCS__BROWSER__TIMEOUT=30000

# browser-use (enterprise, for complex JS sites)
AI_DOCS__BROWSER_USE__ENABLED=false  # true for enterprise
AI_DOCS__BROWSER_USE__LLM_PROVIDER=openai
AI_DOCS__BROWSER_USE__MODEL=gpt-4o-mini
AI_DOCS__BROWSER_USE__MAX_STEPS=20

# Playwright (alternative browser automation)
AI_DOCS__PLAYWRIGHT__BROWSER=chromium
AI_DOCS__PLAYWRIGHT__VIEWPORT_WIDTH=1920
AI_DOCS__PLAYWRIGHT__VIEWPORT_HEIGHT=1080

# ========== Re-ranking (Enterprise Only) ==========
AI_DOCS__RERANKING__ENABLED=false  # true for enterprise
AI_DOCS__RERANKING__MODEL=BAAI/bge-reranker-v2-m3
AI_DOCS__RERANKING__TOP_K=20  # simple: 10
AI_DOCS__RERANKING__BATCH_SIZE=32

# ========== Deployment Features (Enterprise Only) ==========
AI_DOCS__DEPLOYMENT__ENABLED=false  # true for enterprise
AI_DOCS__DEPLOYMENT__STRATEGY=blue_green  # blue_green, canary
AI_DOCS__ALIASES__ENABLE_ALIASES=false  # true for enterprise
AI_DOCS__ALIASES__ACTIVE_ALIAS=active

# Database (enterprise, PostgreSQL)
AI_DOCS__DATABASE__ENABLED=false  # true for enterprise
AI_DOCS__DATABASE__URL=postgresql+asyncpg://user:pass@localhost:5432/ai_docs
AI_DOCS__DATABASE__POOL_SIZE=20  # simple: 5

# Task Queue (enterprise)
AI_DOCS__TASK_QUEUE__ENABLED=false  # true for enterprise
AI_DOCS__TASK_QUEUE__MAX_JOBS=20
AI_DOCS__TASK_QUEUE__JOB_TIMEOUT=600

# Observability (enterprise)
AI_DOCS__OBSERVABILITY__ENABLED=false  # true for enterprise
AI_DOCS__OBSERVABILITY__OTLP_ENDPOINT=http://localhost:4317
AI_DOCS__OBSERVABILITY__TRACE_SAMPLE_RATE=1.0

# Monitoring (enterprise)
AI_DOCS__MONITORING__ENABLED=false  # true for enterprise
AI_DOCS__MONITORING__ENABLE_METRICS=true

# ========== Crawl4AI Settings ==========
AI_DOCS__CRAWL4AI__BROWSER_TYPE=chromium
AI_DOCS__CRAWL4AI__MAX_CONCURRENT=10  # simple: 2
AI_DOCS__CRAWL4AI__PAGE_TIMEOUT=30000
AI_DOCS__CRAWL4AI__USER_AGENT=AIDocs/1.0
AI_DOCS__CRAWL4AI__CACHE_MODE=enabled
AI_DOCS__CRAWL4AI__EXTRACTION_STRATEGY=semantic

# ========== Testing Overrides ==========
# Set RUN_REAL_INTEGRATION_TESTS=true to use real services in tests
RUN_REAL_INTEGRATION_TESTS=false
CRAWL4AI_TIMEOUT=30000  # Test timeout

# For comprehensive mode-specific settings, see docs/developers/configuration.md